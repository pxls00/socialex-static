(window.webpackJsonp=window.webpackJsonp||[]).push([[1,18],{395:function(e,t,r){var content=r(399);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(96).default)("6c5c0534",content,!0,{sourceMap:!1})},398:function(e,t,r){"use strict";var o=r(395),n=r.n(o);r.d(t,"default",(function(){return n.a}))},399:function(e,t,r){var o=r(95)(!1);o.push([e.i,'.block_5XzDG textarea{display:block;width:100%;height:auto;min-height:48px;box-sizing:border-box;color:#000;border-radius:5px;padding:22px 16px 4px;-webkit-appearance:none;-moz-appearance:none;box-shadow:none;outline:none}.block_5XzDG textarea::-webkit-inner-spin-button,.block_5XzDG textarea::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.block_5XzDG textarea::-moz-placeholder{font-size:16px;line-height:1.4;color:rgba(var(--secondary),.8)}.block_5XzDG textarea::placeholder{font-size:16px;line-height:1.4;color:rgba(var(--secondary),.8)}.block_field_elhih{overflow:hidden}.block_input_frw8W{position:relative;flex:1 1 100%;padding-top:20px}.block_placeholder_2Ib-c{position:absolute;top:73px;left:0;cursor:text;font-size:16px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;transition:transform .2s,font-size .2s,color .2s;z-index:2}.block_help_MbKVt,.block_placeholder_2Ib-c{color:rgba(0,0,0,.8);padding:0 16px}.block_help_MbKVt{font-size:12px;line-height:1.2;margin:4px 0 0}.block_help_MbKVt p{margin:0}.block--focus_dUXWN .block_placeholder_2Ib-c{font-size:12px;color:rgba(0,0,0,.5);top:0}.block--filled_GiLcZ .block_placeholder_2Ib-c{font-size:12px;top:0}.block--required_wdfrD .block_placeholder_2Ib-c:after{content:"*";display:inline-block}.block--disabled_kmOKz .block_field_elhih{cursor:not-allowed;opacity:.6}.block--disabled_kmOKz .block_placeholder_2Ib-c{pointer-events:none}.block--disabled_kmOKz textarea{cursor:not-allowed}.block--has-error_ph1yR .block_help_MbKVt,.block--has-error_ph1yR .block_placeholder_2Ib-c{color:#f30}',""]),o.locals={block:"block_5XzDG",block_field:"block_field_elhih",block_input:"block_input_frw8W",block_placeholder:"block_placeholder_2Ib-c",block_help:"block_help_MbKVt","block--focus":"block--focus_dUXWN","block--filled":"block--filled_GiLcZ","block--required":"block--required_wdfrD","block--disabled":"block--disabled_kmOKz","block--has-error":"block--has-error_ph1yR"},e.exports=o},423:function(e,t,r){"use strict";r.r(t);var o=r(52),n=r(3),l=(r(8),r(55),r(57),{name:"AppWysiwyg",components:{"ckeditor-nuxt":function(){return r.e(32).then(r.t.bind(null,453,7))}},model:{prop:"value",event:"change"},props:{value:{type:String,default:""},placeholder:{type:String,default:""},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},hasError:{type:Boolean,default:!1},inputClasses:{type:Array,default:function(){return[]}}},data:function(){return{inFocus:!1,fieldScrollTop:0,editorConfig:{removePlugins:["Title"]}}},methods:{handleChange:function(e){this.$emit("change",e)},handleFocus:function(){this.inFocus=!0,this.$emit("focus")},handleBlur:function(){this.inFocus=!1,this.$emit("blur")},handleWrapperClick:function(){this.$refs.blockTextarea.$el.parentElement.querySelector('[contenteditable="true"]').focus()}}}),c=r(398),d=r(67);var component=Object(d.a)(l,(function(){var e=this,t=e._self._c;return t("div",{ref:"block",class:[e.$style.block,Object(n.a)({},e.$style["block--focus"],e.inFocus),Object(n.a)({},e.$style["block--required"],e.required),Object(n.a)({},e.$style["block--disabled"],e.disabled),Object(n.a)({},e.$style["block--has-error"],e.hasError),Object(n.a)({},e.$style["block--filled"],e.value&&e.value.length)]},[t("div",{class:e.$style.block_field,on:{click:function(t){return t.preventDefault(),e.handleWrapperClick.apply(null,arguments)}}},[t("div",{class:e.$style.block_input},[t("div",{class:e.$style.block_placeholder,style:{marginTop:"-".concat(e.fieldScrollTop,"px")}},[e._v("\n        "+e._s(e.placeholder)+"\n      ")]),e._v(" "),t("ckeditor-nuxt",{ref:"blockTextarea",class:Object(o.a)(e.inputClasses),attrs:{value:e.value,config:e.editorConfig,disabled:e.disabled},on:{input:e.handleChange,focus:e.handleFocus,blur:e.handleBlur}})],1)]),e._v(" "),e.$slots.help?t("div",{class:e.$style.block_help},[e._t("help")],2):e._e()])}),[],!1,(function(e){this.$style=c.default.locals||c.default}),null,null);t.default=component.exports},428:function(e,t,r){"use strict";var o=r(52);r(214);t.a={methods:{applyDrag:function(e,t){var r=t.removedIndex,n=t.addedIndex,l=t.payload;if(null===r&&null===n)return e;var c=Object(o.a)(e),d=l;return null!==r&&(d=c.splice(r,1)[0]),null!==n&&c.splice(n,0,d),c},onDrop:function(e,t){return this.applyDrag(t,e)}}}},438:function(e,t,r){"use strict";var o=r(39);r(73),r(119),r(8),r(42),r(175),r(11),r(60);t.a={methods:{uploadFiles:function(e,t,r){var n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var l,c,d,f;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return n.$loader.show(),l=r.find((function(t){return t.file.name===e.name})),o.prev=2,c=n.$fire.storage.ref("/posts".concat(t?"/".concat(t):"")),o.next=6,c.listAll();case 6:return d=o.sent,o.next=9,d.items;case 9:o.sent.find((function(t){return t.name===e.name}))?n.$notify({message:"You are trying to upload already uploaded image"+e.name,variant:"danger"}):(f=c.child(e.name),f.put(e).on("state_changed",(function(e){var t=(e.bytesTransferred/e.totalBytes*100).toFixed(0);l.uploadedPercent=t}),(function(e){n.handleError(e)}),(function(){l.uploaded=!0}))),o.next=16;break;case 13:o.prev=13,o.t0=o.catch(2),n.handleError(o.t0);case 16:return o.prev=16,n.$loader.hide(),o.finish(16);case 19:case"end":return o.stop()}}),o,null,[[2,13,16,19]])})))()},uploadProfileFile:function(e,t){try{var r=this.$fire.storage.ref("/profile".concat(t?"/".concat(t):"")).child(e.file.name);return new Promise((function(t,o){t(r.putString(e.result.split(",")[1],"base64",{contentType:e.file.type}))}))}catch(e){this.handleError(e)}},getUploadedProfileFile:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n,l,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=[],r.prev=1,l=t.$fire.storage.ref("/profile/".concat(e)),r.next=5,l.listAll();case 5:return c=r.sent,r.next=8,c.items;case 8:r.sent.forEach(function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDownloadURL();case 2:return r=e.sent,e.t0=n,e.next=6,r;case 6:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r.next=15;break;case 12:r.prev=12,r.t0=r.catch(1),t.handleError(r.t0);case 15:return r.prev=15,setTimeout((function(){t.formFields.image=n[n.length-1]}),2e3),r.finish(15);case 18:case"end":return r.stop()}}),r,null,[[1,12,15,18]])})))()},getUploadedPostImages:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n,l,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.$loader.show(),n=[],r.prev=2,l=t.$fire.storage.ref("/posts/".concat(e)),r.next=6,l.listAll();case 6:return c=r.sent,r.next=9,c.items;case 9:r.sent.forEach(function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDownloadURL();case 2:return r=e.sent,e.t0=n,e.next=6,r;case 6:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r.next=16;break;case 13:r.prev=13,r.t0=r.catch(2),t.handleError(r.t0);case 16:return r.prev=16,t.$loader.hide(),r.next=20,n;case 20:return r.abrupt("return",r.sent);case 22:case"end":return r.stop()}}),r,null,[[2,13,16,22]])})))()}}}},439:function(e,t,r){"use strict";t.a={methods:{formatBytes:function(e){if(0==+e)return"0 byte";var i=parseInt(Math.floor(Math.log(+e)/Math.log(1024)));return Math.round(+e/Math.pow(1024,i),2)+" "+["Bytes","KB","MB","GB","TB"][i]}}}},444:function(e,t,r){"use strict";r.r(t);r(13),r(82),r(42);var o=r(39),n=(r(73),r(8),r(30),r(83),r(55),r(11),r(97),r(144),r(119),r(27),r(60),r(214),r(56),r(436)),l=r(215),c=r(397),d=r(438),f=r(428),m=r(439),h={name:"FormPostComponent",components:{AppWysiwyg:r(423).default,Container:n.Container,Draggable:n.Draggable},mixins:[l.validationMixin,d.a,f.a,m.a],props:{},data:function(){return{formFields:{title:"",description:"",images:[],imgFiles:[]},files:[],upload:!1,idFolderStorage:""}},computed:{uploadProcess:function(){return this.formFields.imgFiles.every((function(e){return e.uploaded}))?"Uploaded":"Wait please"}},mounted:function(){this.clearFormData()},methods:{openConfirmModal:function(){this.$bvModal.show("upload")},validateState:function(e){var t=this.$v.formFields[e],r=t.$dirty,o=t.$error;return r?!o:null},clearFormData:function(){this.formFields.title="",this.formFields.description="",this.formFields.images=[],this.formFields.imgFiles=[],this.upload=!1,this.idFolderStorage="",this.files=[]},changeQueue:function(e){if(this.upload&&this.files.length>1)return this.$notify({message:"You can not change queue of images"});this.formFields.imgFiles=this.onDrop(e,this.formFields.imgFiles),this.files=this.formFields.imgFiles.map((function(e){return e.file}))},selectFile:function(e){var t=this,r=Array.from(e.target.files);if(this.upload)return this.$notify({message:"You already uploaded images, so if you want to change, post the post after you can edit the post",variant:"warning"});if(r.length>5||this.files.length+r.length>5)return this.$notify({message:"You can add max 5 images",variant:"warning"});r.forEach((function(e){if(e.type.includes("image")){var r=t.formatBytes(e.size),o=new FileReader;o.onload=function(o){var n={file:e,reader:o.target};t.$set(n,"exists",!1),t.$set(n,"uploadedPercent",0),t.$set(n,"uploaded",!1);var l=t.formFields.imgFiles.find((function(e){return e.file.name===n.file.name}));return e.size>4e5?t.$notify({message:'You are tried to upload the file "'.concat(e.name,'" with size ').concat(r," but max size is 400KB"),variant:"danger"}):l?(l.exists=!0,setTimeout((function(){l.exists=!1}),3e3),t.$notify({message:"You are trying to upload the exists file",variant:"danger"})):void t.formFields.imgFiles.push(n)},o.readAsDataURL(e)}else t.$notify({error:{message:"You are trying to upload the wrong file type."},variant:"danger"})}));var o=this.formFields.imgFiles.map((function(e){return e.file}));this.files=o.length&&o||r},removeImg:function(e){this.formFields.imgFiles.splice(e,1),this.files=this.formFields.imgFiles.map((function(e){return e.file}))},onSubmit:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$v.$touch(),e.$v.$invalid){t.next=18;break}if(e.upload){t.next=6;break}return t.abrupt("return",e.$notify({message:"Please click to upload btn",variant:"warning"}));case 6:if("Wait please"!==e.uploadProcess){t.next=8;break}return t.abrupt("return",e.$notify({message:"Please wait your images are uploading",variant:"warning"}));case 8:return t.prev=8,t.next=11,e.getUploadedPostImages(e.idFolderStorage);case 11:return e.formFields.images=t.sent,t.abrupt("return",e.$emit("submit",e.formFields));case 15:t.prev=15,t.t0=t.catch(8),e.handleError(t.t0);case 18:case"end":return t.stop()}}),t,null,[[8,15]])})))()},uploadToStorage:function(){var e=this;try{this.idFolderStorage=Date.now().toString(),this.upload=!0,this.files.forEach(function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.uploadFiles(r,e.idFolderStorage,e.formFields.imgFiles);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}catch(e){this.handleError(e)}finally{this.$bvModal.hide("upload")}}},validations:{formFields:{title:{required:c.required},description:{required:c.required},imgFiles:{required:c.required}}}},v=h,_=r(67),component=Object(_.a)(v,(function(){var e,t,r=this,o=r._self._c;return o("b-form",{staticClass:"post form form--post",on:{submit:function(e){return e.preventDefault(),r.onSubmit.apply(null,arguments)}}},[o("div",{staticClass:"post__top-create"},[o("div",{staticClass:"post__left"},[o("label",{staticClass:"form-file-label post-file-label",attrs:{for:"file"}},[o("input",{ref:"uploadFile",staticClass:"post-file-input form-file",attrs:{id:"file",type:"file",accept:"image/*",multiple:"",disabled:r.upload},on:{change:r.selectFile}}),r._v(" "),o("div",{staticClass:"post-file-dropzone form-file-dropzone"},[o("span",[o("b-icon",{attrs:{icon:"card-image"}})],1),r._v(" "),o("p",[r._v("Drag or Browse your file")])])]),r._v(" "),r.$v.formFields.imgFiles.$error&&r.$v.$dirty?o("div",{staticClass:"form-file-helpers"},[r.$v.formFields.imgFiles.required?r._e():o("p",[r._v("Field is required")])]):r._e()]),r._v(" "),o("div",{staticClass:"post__right"},[o("b-form-group",{attrs:{label:"Title:","label-for":"input-name"}},[o("b-form-input",{staticClass:"post__input",attrs:{id:"input-name",state:r.validateState("title"),"aria-describedby":"input-title-feedback",type:"text",placeholder:"Post title"},model:{value:r.$v.formFields.title.$model,callback:function(e){r.$set(r.$v.formFields.title,"$model",e)},expression:"$v.formFields.title.$model"}}),r._v(" "),o("b-form-invalid-feedback",{attrs:{id:"input-title-feedback"}},[r.$v.formFields.title.required?r._e():o("p",[r._v("This is a required field")])])],1),r._v(" "),o("b-form-group",[o("client-only",{attrs:{placeholder:"loading..."}},[o("AppWysiwyg",{attrs:{"has-error":r.$v.formFields.description.$error&&r.$v.$dirty,placeholder:"Description"},scopedSlots:r._u([r.$v.formFields.description.$error&&r.$v.$dirty?{key:"help",fn:function(){return[r.$v.formFields.description.required?r._e():o("p",[r._v("\n                Field is required.\n              ")])]},proxy:!0}:null],null,!0),model:{value:r.$v.formFields.description.$model,callback:function(e){r.$set(r.$v.formFields.description,"$model",e)},expression:"$v.formFields.description.$model"}})],1)],1)],1)]),r._v(" "),o("h4",{staticClass:"post__uploaded-images-title"},[r._v("Upload images")]),r._v(" "),null!==(e=r.formFields.imgFiles)&&void 0!==e&&e.length||r.upload?r._e():o("p",{staticClass:"post__uploaded-images-text"},[r._v("\n    You have not added any files to the post yet\n    "),o("span",{on:{click:function(e){return r.$refs.uploadFile.click()}}},[r._v("Please upload")])]),r._v(" "),null!==(t=r.formFields.imgFiles)&&void 0!==t&&t.length?o("div",{staticClass:"post__uploaded-images"},[o("Container",{attrs:{orientation:"horizontal",behaviour:"contain"},on:{drop:r.changeQueue}},r._l(r.formFields.imgFiles,(function(e,t){return o("Draggable",{key:t},[o("div",{class:[{"post__uploaded-image--exists":e.exists},{"post__uploaded-image--uploaded":e.uploaded},"post__uploaded-image"]},[o("img",{attrs:{src:e.reader.result,alt:""}}),r._v(" "),r.upload?r._e():o("div",{staticClass:"post__uploaded-image-remove",on:{click:function(e){return r.removeImg(t)}}},[o("b-icon",{attrs:{icon:"x"}})],1),r._v(" "),e.uploaded?r._e():o("div",{staticClass:"post__uploaded-image-index"},[r._v("\n            "+r._s(t+1)+"\n          ")]),r._v(" "),r.upload?o("div",{staticClass:"post__uploaded-image-percent"},[o("span",[r._v(r._s(e.uploadedPercent)+"%")]),r._v(" "),o("div",{staticClass:"post__uploaded-image-percent-line",style:{width:"".concat(e.uploadedPercent,"%")}})]):r._e(),r._v(" "),o("div",{staticClass:"post__uploaded-image-info"},[o("span",{staticClass:"post__uploaded-image-info-name"},[r._v("\n              "+r._s(e.file.name)+"\n            ")]),r._v(" "),o("span",{staticClass:"post__uploaded-image-info-size"},[r._v("\n              "+r._s(r.formatBytes(e.file.size))+"\n            ")])])])])})),1),r._v(" "),!r.upload&&r.files.length<5?o("div",{staticClass:"post__uploaded-add",on:{click:function(e){return r.$refs.uploadFile.click()}}},[o("span",[o("b-icon",{attrs:{icon:"file-earmark-plus-fill"}})],1)]):r._e()],1):r._e(),r._v(" "),r.formFields.imgFiles.length?o("div",{staticClass:"w-100 d-flex mt-2 mb-4"},[r.upload?r._e():o("button",{staticClass:"button button--sm button--fluid button--warning",attrs:{type:"button"},on:{click:r.openConfirmModal}},[r._v("\n      Upload\n    ")]),r._v(" "),r.upload?o("p",{class:[{"text-warning":"Wait please"===r.uploadProcess},"w-100 text-center text-success"]},[r._v("\n      "+r._s(r.uploadProcess)+"\n      "),o("b-icon",{attrs:{icon:"Wait please"===r.uploadProcess?"hourglass-split":"check2"}})],1):r._e()]):r._e(),r._v(" "),o("div",{staticClass:"w-100 d-flex justify-content-end"},[o("button",{staticClass:"button button-primary",attrs:{type:"submit"}},[r._v("Create")])]),r._v(" "),o("client-only",[o("AppModal",{attrs:{id:"upload"},scopedSlots:r._u([{key:"title",fn:function(){return[r._v(" Upload Images ")]},proxy:!0},{key:"default",fn:function(){return[o("h5",{staticClass:"mb-4 d-flex justify-content-center"},[r._v("\n          Are you sure you want to upload those "+r._s(r.files.length)+" items?\n          You can't add new images after upload !!\n        ")]),r._v(" "),o("div",{staticClass:"d-flex w-100 justify-content-end"},[o("button",{staticClass:"button button--danger mr-2",attrs:{type:"buton"},on:{click:function(e){return r.$bvModal.hide("upload")}}},[r._v("\n            Cancel\n          ")]),r._v(" "),o("button",{staticClass:"button",attrs:{type:"button"},on:{click:r.uploadToStorage}},[r._v("\n            Upload\n          ")])])]},proxy:!0}])})],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);