(window.webpackJsonp=window.webpackJsonp||[]).push([[2,18],{395:function(e,t,n){var content=n(399);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(96).default)("6c5c0534",content,!0,{sourceMap:!1})},398:function(e,t,n){"use strict";var r=n(395),o=n.n(r);n.d(t,"default",(function(){return o.a}))},399:function(e,t,n){var r=n(95)(!1);r.push([e.i,'.block_5XzDG textarea{display:block;width:100%;height:auto;min-height:48px;box-sizing:border-box;color:#000;border-radius:5px;padding:22px 16px 4px;-webkit-appearance:none;-moz-appearance:none;box-shadow:none;outline:none}.block_5XzDG textarea::-webkit-inner-spin-button,.block_5XzDG textarea::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.block_5XzDG textarea::-moz-placeholder{font-size:16px;line-height:1.4;color:rgba(var(--secondary),.8)}.block_5XzDG textarea::placeholder{font-size:16px;line-height:1.4;color:rgba(var(--secondary),.8)}.block_field_elhih{overflow:hidden}.block_input_frw8W{position:relative;flex:1 1 100%;padding-top:20px}.block_placeholder_2Ib-c{position:absolute;top:73px;left:0;cursor:text;font-size:16px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;transition:transform .2s,font-size .2s,color .2s;z-index:2}.block_help_MbKVt,.block_placeholder_2Ib-c{color:rgba(0,0,0,.8);padding:0 16px}.block_help_MbKVt{font-size:12px;line-height:1.2;margin:4px 0 0}.block_help_MbKVt p{margin:0}.block--focus_dUXWN .block_placeholder_2Ib-c{font-size:12px;color:rgba(0,0,0,.5);top:0}.block--filled_GiLcZ .block_placeholder_2Ib-c{font-size:12px;top:0}.block--required_wdfrD .block_placeholder_2Ib-c:after{content:"*";display:inline-block}.block--disabled_kmOKz .block_field_elhih{cursor:not-allowed;opacity:.6}.block--disabled_kmOKz .block_placeholder_2Ib-c{pointer-events:none}.block--disabled_kmOKz textarea{cursor:not-allowed}.block--has-error_ph1yR .block_help_MbKVt,.block--has-error_ph1yR .block_placeholder_2Ib-c{color:#f30}',""]),r.locals={block:"block_5XzDG",block_field:"block_field_elhih",block_input:"block_input_frw8W",block_placeholder:"block_placeholder_2Ib-c",block_help:"block_help_MbKVt","block--focus":"block--focus_dUXWN","block--filled":"block--filled_GiLcZ","block--required":"block--required_wdfrD","block--disabled":"block--disabled_kmOKz","block--has-error":"block--has-error_ph1yR"},e.exports=r},423:function(e,t,n){"use strict";n.r(t);var r=n(52),o=n(3),l=(n(8),n(55),n(57),{name:"AppWysiwyg",components:{"ckeditor-nuxt":function(){return n.e(32).then(n.t.bind(null,453,7))}},model:{prop:"value",event:"change"},props:{value:{type:String,default:""},placeholder:{type:String,default:""},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},hasError:{type:Boolean,default:!1},inputClasses:{type:Array,default:function(){return[]}}},data:function(){return{inFocus:!1,fieldScrollTop:0,editorConfig:{removePlugins:["Title"]}}},methods:{handleChange:function(e){this.$emit("change",e)},handleFocus:function(){this.inFocus=!0,this.$emit("focus")},handleBlur:function(){this.inFocus=!1,this.$emit("blur")},handleWrapperClick:function(){this.$refs.blockTextarea.$el.parentElement.querySelector('[contenteditable="true"]').focus()}}}),c=n(398),d=n(67);var component=Object(d.a)(l,(function(){var e=this,t=e._self._c;return t("div",{ref:"block",class:[e.$style.block,Object(o.a)({},e.$style["block--focus"],e.inFocus),Object(o.a)({},e.$style["block--required"],e.required),Object(o.a)({},e.$style["block--disabled"],e.disabled),Object(o.a)({},e.$style["block--has-error"],e.hasError),Object(o.a)({},e.$style["block--filled"],e.value&&e.value.length)]},[t("div",{class:e.$style.block_field,on:{click:function(t){return t.preventDefault(),e.handleWrapperClick.apply(null,arguments)}}},[t("div",{class:e.$style.block_input},[t("div",{class:e.$style.block_placeholder,style:{marginTop:"-".concat(e.fieldScrollTop,"px")}},[e._v("\n        "+e._s(e.placeholder)+"\n      ")]),e._v(" "),t("ckeditor-nuxt",{ref:"blockTextarea",class:Object(r.a)(e.inputClasses),attrs:{value:e.value,config:e.editorConfig,disabled:e.disabled},on:{input:e.handleChange,focus:e.handleFocus,blur:e.handleBlur}})],1)]),e._v(" "),e.$slots.help?t("div",{class:e.$style.block_help},[e._t("help")],2):e._e()])}),[],!1,(function(e){this.$style=c.default.locals||c.default}),null,null);t.default=component.exports},438:function(e,t,n){"use strict";var r=n(39);n(73),n(119),n(8),n(42),n(175),n(11),n(60);t.a={methods:{uploadFiles:function(e,t,n){var o=this;return Object(r.a)(regeneratorRuntime.mark((function r(){var l,c,d,f;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o.$loader.show(),l=n.find((function(t){return t.file.name===e.name})),r.prev=2,c=o.$fire.storage.ref("/posts".concat(t?"/".concat(t):"")),r.next=6,c.listAll();case 6:return d=r.sent,r.next=9,d.items;case 9:r.sent.find((function(t){return t.name===e.name}))?o.$notify({message:"You are trying to upload already uploaded image"+e.name,variant:"danger"}):(f=c.child(e.name),f.put(e).on("state_changed",(function(e){var t=(e.bytesTransferred/e.totalBytes*100).toFixed(0);l.uploadedPercent=t}),(function(e){o.handleError(e)}),(function(){l.uploaded=!0}))),r.next=16;break;case 13:r.prev=13,r.t0=r.catch(2),o.handleError(r.t0);case 16:return r.prev=16,o.$loader.hide(),r.finish(16);case 19:case"end":return r.stop()}}),r,null,[[2,13,16,19]])})))()},uploadProfileFile:function(e,t){try{var n=this.$fire.storage.ref("/profile".concat(t?"/".concat(t):"")).child(e.file.name);return new Promise((function(t,r){t(n.putString(e.result.split(",")[1],"base64",{contentType:e.file.type}))}))}catch(e){this.handleError(e)}},getUploadedProfileFile:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,l,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=[],n.prev=1,l=t.$fire.storage.ref("/profile/".concat(e)),n.next=5,l.listAll();case 5:return c=n.sent,n.next=8,c.items;case 8:n.sent.forEach(function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDownloadURL();case 2:return n=e.sent,e.t0=o,e.next=6,n;case 6:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(1),t.handleError(n.t0);case 15:return n.prev=15,setTimeout((function(){t.formFields.image=o[o.length-1]}),2e3),n.finish(15);case 18:case"end":return n.stop()}}),n,null,[[1,12,15,18]])})))()},getUploadedPostImages:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,l,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.$loader.show(),o=[],n.prev=2,l=t.$fire.storage.ref("/posts/".concat(e)),n.next=6,l.listAll();case 6:return c=n.sent,n.next=9,c.items;case 9:n.sent.forEach(function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDownloadURL();case 2:return n=e.sent,e.t0=o,e.next=6,n;case 6:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(2),t.handleError(n.t0);case 16:return n.prev=16,t.$loader.hide(),n.next=20,o;case 20:return n.abrupt("return",n.sent);case 22:case"end":return n.stop()}}),n,null,[[2,13,16,22]])})))()}}}},439:function(e,t,n){"use strict";t.a={methods:{formatBytes:function(e){if(0==+e)return"0 byte";var i=parseInt(Math.floor(Math.log(+e)/Math.log(1024)));return Math.round(+e/Math.pow(1024,i),2)+" "+["Bytes","KB","MB","GB","TB"][i]}}}},451:function(e,t,n){"use strict";n.r(t);n(42);var r=n(39),o=(n(73),n(14),n(97),n(144),n(27),n(8),n(56),n(60),n(215)),l=n(397),c=n(448),d=n(439),f=n(438),m=n(423),h=(n(449),{name:"FormSettingsComponent",components:{AppWysiwyg:m.default,Cropper:c.a},mixins:[o.validationMixin,d.a,f.a],props:{initialData:{type:Object,required:!0}},data:function(){return{formFields:{name:"",username:"",bio:"",email:"",imageFile:{},image:""},file:""}},mounted:function(){this.setFormData(this.initialData)},methods:{deleteAccount:function(){this.$emit("deleteAccount"),this.$bvModal.hide("deleteAccount")},cancelUpdateClicked:function(){this.formFields.name!==this.initialData.name||this.formFields.username!==this.initialData.username||this.formFields.bio!==this.initialData.bio||Object.keys(this.formFields.imageFile).length?this.$bvModal.show("cancelUpdate"):this.cancelUpdate()},cancelUpdate:function(){this.clearFormData(),this.$router.push(this.$getRoutePath("home"))},validateState:function(e){var t=this.$v.formFields[e],n=t.$dirty,r=t.$error;return n?!r:null},setFormData:function(data){Object.keys(data).length&&(this.formFields.name=data.name,this.formFields.username=data.username,this.formFields.bio=data.bio,this.formFields.email=data.email,this.formFields.image=data.image)},clearFormData:function(){this.formFields.name="",this.formFields.username="",this.formFields.bio="",this.formFields.email="",this.formFields.image="",this.formFields.imageFile={},this.file=""},selectFile:function(e){var t=this;this.$loader.show();var n=e.target.files[0],r=this.formatBytes(n.size);return n.type.includes("image")?n.size>4e5?(this.$loader.hide(),void this.$notify({message:'You are tried to upload the file "'.concat(n.name,'" with size ').concat(r," but max size is 400KB"),variant:"danger"})):void new Promise((function(e,t){var r=new FileReader;r.onload=function(t){e({file:n,url:t.target.result})},r.readAsDataURL(n),r.error&&t(r.error)})).then((function(e){t.$loader.hide(),t.formFields.imageFile=e,t.$set(t.formFields.imageFile,"uploaded",!1),t.$bvModal.show("cropImage")})):(this.$loader.hide(),void this.$notify({message:'You are tried to upload the wrong file type "'.concat(n.type,"\" accepts only for ['.png', '.jpg', '.jpeg', '.gif']"),variant:"danger"}))},closeCropModal:function(){this.formFields.imageFile="",this.$bvModal.hide("cropImage")},cropImage:function(){var e=this.$refs.cropper.getResult();this.file=this.formFields.imageFile.file,this.$set(this.formFields.imageFile,"result",e.canvas.toDataURL(this.formFields.imageFile.file.type)),this.$bvModal.hide("cropImage")},uploadFile:function(){var e=this;try{var t=this.initialData._id.toString();this.uploadProfileFile(this.formFields.imageFile,t).then((function(){e.getUploadedFile()}))}catch(e){this.handleError(e)}},getUploadedFile:function(){var e=this;try{var t=this.initialData._id.toString();this.getUploadedProfileFile(t).then((function(){setTimeout((function(){e.$emit("submit",e.formFields)}),3e3)}))}catch(e){this.handleError(e)}},onSubmit:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$loader.show(),e.$v.$touch(),e.$v.$invalid){t.next=9;break}if(!Object.keys(e.formFields.imageFile).length||!e.formFields.imageFile){t.next=8;break}return t.next=6,e.uploadFile();case 6:t.next=9;break;case 8:e.$emit("submit",e.formFields);case 9:case"end":return t.stop()}}),t)})))()}},validations:{formFields:{name:{required:l.required,minLength:Object(l.minLength)(5),maxLength:Object(l.maxLength)(30)},email:{required:l.required,email:l.email},username:{maxLength:Object(l.maxLength)(30)}}}}),v=n(67),component=Object(v.a)(h,(function(){var e,t=this,n=t._self._c;return n("b-form",{staticClass:"settings form form--post",on:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[n("div",{staticClass:"settings__top"},[n("div",{staticClass:"settings__left"},[n("label",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"form-file-label post-file-label",attrs:{for:"file"}},[n("input",{ref:"uploadFile",staticClass:"post-file-input form-file",attrs:{id:"file",type:"file",accept:"image/*"},on:{change:t.selectFile}}),t._v(" "),n("div",{staticClass:"post-file-dropzone form-file-dropzone"},[n("span",[n("b-icon",{attrs:{icon:"card-image"}})],1),t._v(" "),n("p",[t._v("Drag or Browse your profile image")])])]),t._v(" "),n("div",{staticClass:"settings__left-avatar"},[n("img",{attrs:{src:"result"in t.formFields.imageFile?t.formFields.imageFile.result:null===(e=t.formFields)||void 0===e?void 0:e.image}}),t._v(" "),n("div",{staticClass:"settings__left-avatar-btn",on:{click:function(e){return t.$refs.uploadFile.click()}}},[n("span",[n("b-icon",{attrs:{icon:"camera"}})],1),t._v(" "),n("p",[t._v("Change Photo")])])])]),t._v(" "),n("div",{staticClass:"settings__right"},[n("b-form-group",{attrs:{label:"Name:","label-for":"input-name"}},[n("b-form-input",{staticClass:"settings__input",attrs:{id:"input-name",state:t.validateState("name"),"aria-describedby":"input-name-feedback",type:"text",placeholder:"User name:"},model:{value:t.$v.formFields.name.$model,callback:function(e){t.$set(t.$v.formFields.name,"$model",e)},expression:"$v.formFields.name.$model"}}),t._v(" "),n("b-form-invalid-feedback",{attrs:{id:"input-name-feedback"}},[t.$v.formFields.name.required?t._e():n("p",[t._v("This is a required field")])])],1),t._v(" "),n("b-form-group",{attrs:{label:"Email:","label-for":"input-email"}},[n("b-form-input",{staticClass:"settings__input",attrs:{id:"input-email",state:t.validateState("email"),"aria-describedby":"input-email-feedback",type:"email",placeholder:"User email:"},model:{value:t.$v.formFields.email.$model,callback:function(e){t.$set(t.$v.formFields.email,"$model",e)},expression:"$v.formFields.email.$model"}}),t._v(" "),n("b-form-invalid-feedback",{attrs:{id:"input-email-feedback"}},[t.$v.formFields.email.required?t.$v.formFields.email.email?t._e():n("p",[t._v("\n            This field must include @\n          ")]):n("p",[t._v("This is a required field")])])],1)],1)]),t._v(" "),n("div",{staticClass:"settings__field"},[n("b-form-group",{attrs:{label:"User name:","label-for":"input-username"}},[n("b-form-input",{staticClass:"settings__input",attrs:{id:"input-username",type:"text",placeholder:"User username:"},model:{value:t.formFields.username,callback:function(e){t.$set(t.formFields,"username",e)},expression:"formFields.username"}})],1)],1),t._v(" "),n("div",{staticClass:"settings__field"},[n("b-form-group",[n("client-only",{attrs:{placeholder:"loading..."}},[n("AppWysiwyg",{staticClass:"w-100",attrs:{placeholder:"User bio"},model:{value:t.formFields.bio,callback:function(e){t.$set(t.formFields,"bio",e)},expression:"formFields.bio"}})],1)],1)],1),t._v(" "),n("div",{staticClass:"w-100 d-flex justify-content-end mt-5"},[n("button",{staticClass:"button button--danger mr-1",attrs:{type:"button"},on:{click:function(e){return t.$bvModal.show("deleteAccount")}}},[t._v("\n      Delete Account\n    ")]),t._v(" "),n("button",{staticClass:"button button--warning mr-1",attrs:{type:"button"},on:{click:t.cancelUpdateClicked}},[t._v("\n      Cancel\n    ")]),t._v(" "),n("button",{staticClass:"button",attrs:{type:"submit"}},[t._v("Update")])]),t._v(" "),n("client-only",[n("AppModal",{attrs:{id:"deleteAccount"},scopedSlots:t._u([{key:"default",fn:function(){return[n("h5",{staticClass:"mb-4"},[t._v("\n          Are you sure you want to delete your account? \n          All your data will be lost and cannot be recovered !!\n        ")]),t._v(" "),n("div",{staticClass:"d-flex w-100 justify-content-end"},[n("button",{staticClass:"button mr-2",attrs:{type:"buton"},on:{click:function(e){return t.$bvModal.hide("deleteAccount")}}},[t._v("\n            Cancel\n          ")]),t._v(" "),n("button",{staticClass:"button button--danger",attrs:{type:"button"},on:{click:t.deleteAccount}},[t._v("\n            Delete\n          ")])])]},proxy:!0}])})],1),t._v(" "),n("client-only",[n("AppModal",{attrs:{id:"cancelUpdate"},scopedSlots:t._u([{key:"default",fn:function(){return[n("h5",{staticClass:"mb-4"},[t._v("Are you sure you want to stop the update ?")]),t._v(" "),n("div",{staticClass:"d-flex w-100 justify-content-end"},[n("button",{staticClass:"button mr-2",attrs:{type:"buton"},on:{click:function(e){return t.$bvModal.hide("cancelUpdate")}}},[t._v("\n            No\n          ")]),t._v(" "),n("button",{staticClass:"button button--danger",attrs:{type:"button"},on:{click:t.cancelUpdate}},[t._v("\n            Yes\n          ")])])]},proxy:!0}])})],1),t._v(" "),n("client-only",[n("AppModal",{attrs:{id:"cropImage"}},[n("Cropper",{ref:"cropper",staticClass:"cropper",attrs:{"stencil-props":{aspectRatio:1},debounce:!1,src:t.formFields.imageFile?t.formFields.imageFile.url:t.formFields.image}}),t._v(" "),n("div",{staticClass:"d-flex w-100 justify-content-end mt-4"},[n("button",{staticClass:"button button--danger",on:{click:t.closeCropModal}},[t._v("\n          Cancel\n        ")]),t._v(" "),n("button",{staticClass:"button ml-2",on:{click:t.cropImage}},[t._v("Crop")])])],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);